{
   "schemaVersion": 2,
   "dockerfileLines": [
      "FROM postgres:15",
      "RUN apt-get update && apt-get install -y pgbackrest openssh-client openssh-server && rm -rf /var/lib/apt/lists/*",
      "ENV POSTGRES_USER=postgres",
      "ENV POSTGRES_PASSWORD=postgres",
      "ENV PGDATA=/var/lib/postgresql/data",
      "ENV BACKREST_STANZA=psql",
      "ENV BACKREST_REPO1_PATH=/var/lib/pgbackrest",
      "RUN mkdir -p /var/lib/pgbackrest && mkdir -p /var/lib/postgresql/.ssh",
      "RUN chown -R postgres:postgres /var/lib/pgbackrest /var/lib/postgresql/.ssh",
      "RUN chmod 700 /var/lib/postgresql/.ssh",
      "COPY ./entrypoint.sh /usr/local/bin/entrypoint.sh",
      "RUN chmod +x /usr/local/bin/entrypoint.sh",
      "VOLUME [\"/var/lib/postgresql/data\", \"/var/lib/pgbackrest\", \"/var/lib/postgresql/.ssh\"]",
      "EXPOSE 5432",
      "ENTRYPOINT [\"/usr/local/bin/entrypoint.sh\"]",
      "CMD [\"postgres\"]"
   ]
}
